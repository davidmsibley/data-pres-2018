{"version":3,"file":"index.min.js","sources":["../../app/map/restyling-circle-marker.js","../../app/map/site-map.js","../../app/filter/filter-controls.js","../../app/site-data.js","../../app/site-router.js","../../app/details/layout/table-layout.js","../../app/details/layout/log-layout.js","../../app/details/layout/core-layout.js","../../app/details/layout-resolver.js","../../app/details/site-details.js","../../app/filter/filter-summary.js","../../app/filter/map-filter.js","../../app/index.js"],"sourcesContent":["\nconst colorRange = [\n  '#e0ecf4',\n  '#bfd3e6',\n  '#9ebcda',\n  '#8c96c6',\n  '#8c6bb1',\n  '#88419d',\n  '#810f7c'\n];\nexport const RestylingCircleMarker = L.CircleMarker.extend({\n  getEvents: function() {\n    return {\n      zoomend: this._restyle,\n      filterpoints: this._filter\n    }\n  }, \n  _restyle: function(e){\n    this.setRadius(RestylingCircleMarker.calcRadius(e.target.getZoom()))\n  },\n  _filter: function(e) {\n    let isDisplayable = e.detail.resolve(this.feature.properties);\n    if (isDisplayable) {\n      this.setStyle({\n        stroke: true,\n        fill: true\n      })\n    } else {\n      this.setStyle({\n        stroke: false,\n        fill: false\n      })\n    }\n  },\n  highlight: function() {\n    this._activeBackup = {\n      color: this.options.color,\n      stroke: this.options.stroke,\n      fill: this.options.fill\n    };\n    this.setStyle({\n      color: 'var(--palette-active)',\n      stroke: true,\n      fill: true\n    })\n  },\n  removeHighlight: function() {\n    if (this._activeBackup) {\n      this.setStyle(this._activeBackup);\n      this._activeBackup = null;\n    }\n  }\n});\n\nRestylingCircleMarker.calcRadius = (a) => Math.max(Math.floor(a/1.5),3);","import { RestylingCircleMarker } from './restyling-circle-marker.js';\n\nexport class SiteMap extends window.L.Evented {\n  constructor() {\n    super();\n    this.selected = false;\n    this._highlight = null;\n\n    /* ~~~~~~~~ Map ~~~~~~~~ */\n    //create a map, center it, and set the zoom level. \n    //set zoomcontrol to false because we will add it in a different corner. \n    const map = this.map = L.map('map', {zoomControl:false}).setView([45, -89.623861], 7);\n    this.el = document.querySelector('#map');\n     \n     /* ~~~~~~~~ Zoom Control ~~~~~~~~ */\n    //place a zoom control in the top right: \n    new L.Control.Zoom({position: 'topright'}).addTo(map);\n\n     \n    /* ~~~~~~~~ Basemap Layers ~~~~~~~~ */\n     \n    // basemaps from Open Street Map\n    const osmhot = L.tileLayer('https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {\n      attribution: '&copy; <a href=\"https://osm.org/copyright\">OpenStreetMap</a> contributors', \n      label: \"OpenStreetMap Humanitarian\"\n    }).addTo(map);\n\n    // Esri basemaps \n    const esrisat = L.esri.basemapLayer('Imagery', {label: \"Esri Satellite\"});\n    \n    // add the basemap control to the map  \n    var basemaps = [osmhot, esrisat]; \n    map.addControl(L.control.basemaps({\n       basemaps: basemaps, \n       tileX: 0, \n       tileY: 0, \n       tileZ: 1\n    })); \n\n    let boreURL = 'https://data.wgnhs.wisc.edu/arcgis/rest/services/geologic_data/borehole_geophysics/MapServer/0/query?where=1%3D1&inSR=4326&outFields=*&returnGeometry=true&geometryPrecision=6&outSR=4326&f=geojson';\n    let quatURL = 'https://data.wgnhs.wisc.edu/arcgis/rest/services/geologic_data/sediment_core/MapServer/0/query?where=1%3D1&inSR=4326&outFields=*&returnGeometry=true&geometryPrecision=6&outSR=4326&f=geojson';\n    Promise.all([\n      window.fetch(boreURL).then((res) => res.json()).then((geojson)=>({name: 'Geophysical Log Data', color: 'var(--palette-blue)', data: geojson})), \n      window.fetch(quatURL).then((res) => res.json()).then((geojson)=>({name: 'Quaternary Core Data', color: 'var(--palette-green)', data: geojson}))\n    ]).then((responses) => {\n        this.layers = responses.map((res) => {\n          return L.geoJSON(res.data, {\n            name: res.name,\n            pointToLayer: function(geoJsonPoint, latlon) {\n              return new RestylingCircleMarker(latlon, {\n                weight: 2,\n                color: res.color,\n                radius: RestylingCircleMarker.calcRadius(map.getZoom()),\n                stroke: false,\n                fill: false\n              });\n            }\n          });\n        });\n        this.layers.forEach(l => l.on('click', (e) => {\n          if (this._highlight !== e.propagatedFrom) {\n            this.fire('interaction', e.propagatedFrom.feature.properties);\n          } else {\n            this.fire('interaction');\n          }\n        }))\n        this.layers.forEach(l => l.addTo(map));\n      let lookup = {};\n      this.layers.forEach(function(layer, idx, arr) {\n        layer.eachLayer(function(obj) {\n          let wid = obj.feature.properties['Wid'] || obj.feature.properties['WGNHS_ID'];\n          let siteCode = SiteMap.getSiteCode(obj.feature.properties);\n          let siteName = obj.feature.properties['Site_Name'] || obj.feature.properties['SiteName'];\n          let latLon = obj.getLatLng();\n          let cache = lookup[siteCode] || {\n            'Site_Code': siteCode,\n            'Site_Name': siteName,\n            'Wid': wid,\n            'Latitude': latLon['lat'].toFixed(6),\n            'Longitude': latLon['lng'].toFixed(6),\n            point: obj,\n            datas: new Array(arr.length)\n          };\n          obj.feature.properties['Site_Code'] = siteCode;\n          obj.feature.properties['Data_Type'] = layer.options.name;\n\n          cache.datas[idx] = obj.feature.properties;\n          lookup[siteCode] = cache;\n        });\n      });\n      this._lookup = lookup;\n      this.fire('init');\n    });\n  }\n\n  static getSiteCode(params) {\n    let keys = ['Wid', 'WGNHS_ID', 'ID', 'Site_Code'];\n    let result = keys.reduce((prev, curr) => {\n      return prev || params[curr];\n    }, undefined)\n    return result;\n  }\n\n  //TODO HACK\n  getPoint(params) {\n    let result = null;\n    let cache = this._lookup[SiteMap.getSiteCode(params)];\n    if (cache) {\n      result = cache.point;\n    }\n    return result;\n  }\n\n  getSite(params) {\n    let result = this._lookup[SiteMap.getSiteCode(params)];\n    return result;\n  }\n\n  zoomToPoint(site) {\n    let point = this.getPoint(site);\n    if (point) {\n      this.map.setZoomAround(point.getLatLng(), 15);\n    }\n  }\n\n  getHighlightPoint() {\n    // console.log('retrieve highlight point');\n    let result = this._highlight;\n    return result;\n  }\n\n  setHighlightPoint(point) {\n    if (point) {\n      // console.log('set highlight point');\n      this._highlight = point;\n      this._highlight.bringToFront()\n      this._highlight.highlight();\n    } else {\n      this.clearSelection();\n    }\n  }\n\n  selectPoint(params) {\n    let result = null;\n    // console.log('select point on map:', site);\n    let point = this.getPoint(params);\n    if (point) {\n      result = point.feature.properties;\n      let highlightPoint = this.getHighlightPoint();\n      if (point !== highlightPoint) {\n        this.clearSelection();\n        this.setHighlightPoint(point);\n      }\n    }\n    return result;\n  }\n\n  selectSite(params) {\n    let result = this.getSite(params);\n    this.selectPoint(params);\n    return result;\n  }\n\n  clearSelection() {\n    // console.log('clear highlight group');\n    if (this._highlight) {\n      this._highlight.bringToBack();\n      this._highlight.removeHighlight();\n    }\n    this._highlight = null;\n  }\n\n  updatePoints(activePoints) {\n    this.map.fire('filterpoints', {\n      detail: {\n        resolve: (props) => {\n          return activePoints.reduce((prev, activeSet) => {\n            const code = SiteMap.getSiteCode(props);\n            const has = activeSet.has('' + code);\n            const result = prev || has;\n            return result;\n          }, false);\n        }\n      }\n    });\n  }\n\n  setVisibility(isVisible) {\n    if (isVisible) {\n      this.el.removeAttribute('data-closed');\n      this.map.invalidateSize();\n    } else {\n      this.el.setAttribute('data-closed', true);\n    }\n  }\n\n}","import { html } from 'lit-element';\nimport { genId } from 'wgnhs-common';\n\nexport class FilterGroup {\n  constructor(config) {\n    Object.assign(this, config);\n    if (!this.id) {\n      this.id = genId();\n    }\n  }\n  activate(context) {\n    let result = null;\n    const input = context.detail.checked;\n    if (context.toggleable && input) {\n      result = {\n        id: context.id,\n        resolve: function(feature) {\n          return feature[context.prop] === context.value;\n        }\n      };\n    }\n    return result;\n  }\n}\n\nexport class CheckboxControl {\n  constructor() {\n    this.id = genId();\n  }\n  get next() {\n    return html`\n      <input type=\"checkbox\">\n    `;\n  }\n  handle(context) {\n    let result = null;\n\n    let input = context.target.nextElementSibling.checked;\n    // blank selects all, apply filter if non-blank\n    if (input) {\n      result = {\n        id: context.id,\n        resolveGroup: function(feature) {\n          return !context.group.prop || context.group[context.group.prop] === feature[context.group.prop]\n        },\n        resolve: function(feature) {\n          // filter out features without the property\n          let isValid = !!feature[context.prop]\n          return isValid;\n        }\n      };\n    }\n    return result;\n  }\n}\n\nexport class GTLTControl {\n  constructor(isDate) {\n    this.id = genId();\n    this.gtName = (isDate)?'after':'at least';\n    this.ltName = (isDate)?'before':'less than';\n  }\n  get next() {\n    return html`\n      <select>\n        <option value=\"gt\">${this.gtName}</option>\n        <option value=\"lt\">${this.ltName}</option>\n      </select>\n      <input type=\"text\">\n    `;\n  }\n  handle(context) {\n    let result = null;\n    context['gt'] = (a, b) => (a >= b);\n    context['lt'] = (a, b) => (a < b);\n\n    const predicate = context[context.target.nextElementSibling.value];\n    const input = context.target.nextElementSibling.nextElementSibling.value;\n    // blank selects all, apply filter if non-blank\n    if (input) {\n      result = {\n        id: context.id,\n        resolveGroup: function(feature) {\n          return !context.group.prop || context.group[context.group.prop] === feature[context.group.prop]\n        },\n        resolve: function(feature) {\n          // filter out features without the property\n          let isValid = !!feature[context.prop];\n          if (isValid) {\n            isValid = predicate(feature[context.prop], input);\n          }\n          return isValid;\n        }\n      };\n    }\n    return result;\n  }\n}\n\nexport class SelectControl {\n  constructor() {\n    this.id = genId();\n  }\n  get next() {\n    return html`\n      <select ?disabled=\"${!this.options}\">\n        <option></option>\n        ${(!this.options)?'':this.options.map((el) => html`\n        <option value=\"${el}\">${el}</option>\n        `)}\n      </select>\n    `;\n  }\n  init(uniques) {\n    if (!this.options) {\n      this.options = Array.from(uniques).sort();\n    }\n  }\n  handle(context) {\n    let result = null;\n\n    const input = context.target.nextElementSibling.value;\n    // blank selects all, apply filter if non-blank\n    if (input) {\n      result = {\n        id: context.id,\n        resolveGroup: function(feature) {\n          return !context.group.prop || context.group[context.group.prop] === feature[context.group.prop]\n        },\n        resolve: function(feature) {\n          // filter out features without the property\n          let isValid = !!feature[context.prop];\n          if (isValid) {\n            const value = feature[context.prop]\n            isValid = value === input;\n          }\n          return isValid;\n        }\n      };\n    }\n    return result;\n  }\n}\n\nexport class TextControl {\n  constructor() {\n    this.id = genId();\n  }\n  get next() {\n    return html`\n      <input type=\"text\">\n    `;\n  }\n  handle(context) {\n    let result = null;\n\n    const input = ('' + context.target.nextElementSibling.value).trim().toUpperCase();\n    // blank selects all, apply filter if non-blank\n    if (input) {\n      result = {\n        id: context.id,\n        resolveGroup: function(feature) {\n          return !context.group.prop || context.group[context.group.prop] === feature[context.group.prop]\n        },\n        resolve: function(feature) {\n          // filter out features without the property\n          let isValid = !!feature[context.prop];\n          if (isValid) {\n            const value = ('' + feature[context.prop]).trim().toUpperCase();\n            isValid = value === input;\n          }\n          return isValid;\n        }\n      };\n    }\n    return result;\n  }\n}\n\nexport class ContainsControl {\n  constructor() {\n    this.id = genId();\n  }\n  get next() {\n    return html`\n      <input type=\"text\">\n    `;\n  }\n  handle(context) {\n    let result = null;\n\n    const input = ('' + context.target.nextElementSibling.value).trim().toUpperCase();\n    // blank selects all, apply filter if non-blank\n    if (input) {\n      result = {\n        id: context.id,\n        resolveGroup: function(feature) {\n          return !context.group.prop || context.group[context.group.prop] === feature[context.group.prop]\n        },\n        resolve: function(feature) {\n          // filter out features without the property\n          let isValid = !!feature[context.prop];\n          if (isValid) {\n            const value = ('' + feature[context.prop]).trim().toUpperCase();\n            isValid = value.includes(input);\n          }\n          return isValid;\n        }\n      };\n    }\n    return result;\n  }\n}","import {\n  FilterGroup,\n  CheckboxControl,\n  GTLTControl,\n  SelectControl,\n  TextControl,\n  ContainsControl\n} from './filter/filter-controls.js';\n\nexport class SiteData {\n  constructor(layers) {\n\n    // Define aggregated data for visualization\n    this._aggrKeys = [\n      'County',\n      'Drill_Meth'\n    ];\n    this.aggrData = [];\n    for (let l of layers) {\n      this.aggrData.push(SiteData._gatherAggrData(l, this._aggrKeys));\n    }\n\n    this.datas = this.aggrData.map((el)=>el.data).reduce((prev, curr)=>prev.concat(curr),[]);\n    this.uniques = {};\n    this._aggrKeys.forEach((key) => this.uniques[key] = new Set(this.datas.map((el)=>el[key]).filter((el)=>!!el)));\n  }\n\n  static _gatherAggrData(layer, aggrKeys) {\n    const aggrData = {\n      aggr: {},\n      data: []\n    };\n\n    // Collect datasets and aggregates\n    layer.eachLayer(function(obj, l) {\n      let result = {};\n      aggrKeys.forEach(function(key) {\n        result[key] = obj.feature.properties[key]\n        if (!aggrData.aggr[key]) {\n          aggrData.aggr[key] = {};\n        }\n        let group = aggrData.aggr[key];\n        if (result[key] && 'number' === typeof result[key]) {\n          if (!group.max || group.max < result[key]) {\n            group.max = result[key];\n          }\n          if (!group.min || group.min > result[key]) {\n            group.min = result[key];\n          }\n        }\n      });\n      aggrData.data.push(result);\n    });\n\n    return aggrData;\n  }\n}\n\nexport const ignoredKeys = [\n  'Site_Code',\n  'Data_Type',\n  'SiteName',\n  'Site_Name',\n  'Wid',\n  'ID',\n  'County'\n];\nexport const keyLookup = {\n  'SiteName': {title: 'Site Name', desc: ''},\n  'Site_Name': {title: 'Site Name', desc: ''},\n  'Wid': {title: 'WID', desc: ''},\n  'ID': {title: 'ID', desc: ''},\n  'RecentLog': {title: 'Most recent log (year)', desc: ''},\n  'MaxDepth': {title: 'Max depth (ft)', desc: ''},\n  'Norm_Res': {title: 'Normal Resistivity', desc: ''},\n  'Caliper': {title: 'Caliper', desc: ''},\n  'Gamma': {title: 'Natural Gamma', desc: ''},\n  'SP': {title: 'Spontaneous (Self) Potential', desc: ''},\n  'SPR': {title: 'Single Point Resistivity', desc: ''},\n  'Spec_Gamma': {title: 'Spectral Gamma', desc: ''},\n  'Fluid_Cond': {title: 'Fluid Conductivity', desc: ''},\n  'Flow_Spin': {title: 'Spinner Flow Meter', desc: ''},\n  'Fluid_Temp': {title: 'Fluid Temperature', desc: ''},\n  'Fluid_Res': {title: 'Fluid Resistivity', desc: ''},\n  'OBI': {title: 'Optical Borehole Image (OBI)', desc: ''},\n  'ABI': {title: 'Acoustic Borehole Image (ABI)', desc: ''},\n  'Video': {title: 'Video', desc: ''},\n  'Drill_Year': {title: 'Drill year', desc: ''},\n  'Depth_Ft': {title: 'Depth (ft)', desc: ''},\n  'Drill_Meth': {title: 'Drill Method', desc: ''},\n  'Subsamples': {title: 'Subsamples', desc: ''},\n  'Photos': {title: 'Core Photos', desc: ''},\n  'Grainsize': {title: 'Grainsize', desc: ''},\n};\n\nexport const filterLookup = [\n  new FilterGroup({\n    title: \"Site Information\",\n    open: true,\n    sections: [\n      {\n        fields: {\n          \"County\": {\n            controls: [\n              new SelectControl()\n            ]\n          },\n          // \"SiteName\": {\n          //   controls: [\n          //     new ContainsControl()\n          //   ]\n          // },\n          \"Site_Name\": {\n            controls: [\n              new ContainsControl()\n            ]\n          },\n          \"Wid\": {\n            controls: [\n              new TextControl()\n            ]\n          },\n        }\n      }\n    ]\n  }),\n  new FilterGroup({\n    title: \"Geophysical Log Data\",\n    prop: 'Data_Type',\n    'Data_Type': 'Geophysical Log Data',\n    toggleable: true,\n    active: true,\n    sections: [\n      {\n        fields: {\n          \"RecentLog\": {\n            controls: [\n              new GTLTControl(true)\n            ]\n          },\n          \"MaxDepth\": {\n            controls: [\n              new GTLTControl()\n            ]\n          }\n        }\n      },\n      {\n        title: \"Geologic\",\n        fields: {\n          \"Norm_Res\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"Caliper\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"Gamma\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"SP\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"SPR\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"Spec_Gamma\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n\n        }\n      },\n      {\n        title: \"Hydrogeologic\",\n        fields: {\n          \"Fluid_Cond\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"Flow_Spin\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"Fluid_Temp\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"Fluid_Res\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"Flow_HP\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n\n        }\n      },\n      {\n        title: \"Image\",\n        fields: {\n          \"OBI\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"ABI\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"Video\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n\n        }\n      }\n    ]\n  }),\n  new FilterGroup({\n    title: \"Quaternary Core Data\",\n    prop: 'Data_Type',\n    'Data_Type': 'Quaternary Core Data',\n    toggleable: true,\n    active: true,\n    sections: [\n      {\n        fields: {\n          \"Drill_Year\": {\n            controls: [\n              new GTLTControl(true)\n            ]\n          },\n          \"Depth_Ft\": {\n            controls: [\n              new GTLTControl()\n            ]\n          },\n          \"Drill_Meth\": {\n            controls: [\n              new SelectControl()\n            ]\n          },\n        }\n      },\n      {\n        title: \"Analyses available\",\n        fields: {\n          \"Subsamples\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"Photos\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          },\n          \"Grainsize\": {\n            controls: [\n              new CheckboxControl()\n            ]\n          }\n        }\n      }\n    ]\n  })\n];","import { pushStateLocationPlugin, servicesPlugin, UIRouter } from '@uirouter/core';\n\nconst DEFAULT_ROUTE = 'entry';\n\nexport class SiteRouter extends window.L.Evented {\n\n  constructor() {\n    super();\n    this.router = new UIRouter();\n    this.router.plugin(pushStateLocationPlugin);\n    this.router.plugin(servicesPlugin);\n    this.routes = {};\n  }\n\n  start() {\n    this.router.urlService.rules.initial({ state: DEFAULT_ROUTE });\n    this.router.urlService.rules.otherwise({ state: DEFAULT_ROUTE });\n    // this.router.trace.enable(1);\n    this.router.urlService.listen();\n    this.router.urlService.sync();\n  }\n\n  addRoute(config) {\n    if (config && config.name) {\n      this.routes[config.name] = config;\n      this.router.stateRegistry.register(config);\n    }\n  }\n\n  /**\n   * clear selection\n   */\n  clearRoute() {\n    this.setRoute();\n  }\n\n  setRoute(name, params) {\n    if (arguments.length > 0 && this.routes[name]) {\n      this.router.stateService.go(name, params);\n    } else {\n      this.router.stateService.go(DEFAULT_ROUTE);\n    }\n  }\n\n  link(name, params) {\n    let result = '';\n    if (params) {\n      result = this.router.stateService.href(name, params);\n    } else {\n      result = this.router.stateService.href(name);\n    }\n    return result;\n  }\n\n  onEnterAll(options, func) {\n    this.router.transitionService.onEnter(options, func);\n  }\n  onExitAll(options, func) {\n    this.router.transitionService.onExit(options, func);\n  }\n}","import { LitElement, html, css } from 'lit-element';\nimport { ignoredKeys, keyLookup } from '../../site-data.js';\n\nexport class TableLayout extends LitElement {\n\n  static get layoutName() {\n    return undefined;\n  }\n\n  static include(info, context) {\n    return html`<table-layout .info=${info} .context=${context}></table-layout>`;\n  }\n\n  static get properties() {\n    return {\n      info: {\n        type: Object\n      },\n      context: {\n        type: Object\n      }\n    };\n  }\n\n  constructor() {\n    super();\n  }\n\n  static get styles() {\n    return css`\n      [data-element=\"table\"] {\n        display: grid;\n        grid-template-columns: 40% 1fr;\n        grid-gap: var(--border-radius);\n        margin: 0 var(--border-radius);\n      }\n      .label {\n        font-weight: var(--font-weight-bold);\n      }\n    `;\n  }\n\n  render() {\n    let key = 0, value = 1;\n    let entries = Object.entries(this.info).filter((el) => {\n      return !ignoredKeys.includes(el[key]);\n    }).map((el, index) => html`\n      <td class=\"label\" title=\"${(keyLookup[el[key]])?keyLookup[el[key]].desc:el[key]}\">\n        <label for=\"${this.context.genId(index)}\" >\n          ${(keyLookup[el[key]])?keyLookup[el[key]].title:el[key]}\n        </label>\n      </td>\n      <td class=\"detail\" title=\"${(keyLookup[el[key]])?keyLookup[el[key]].desc:el[key]}\">\n        <span id=\"${this.context.genId(index)}\">\n          ${el[value]}\n        </span>\n      </td>\n    `);\n    return html`\n      <div data-element=\"table\">\n        ${entries}\n      </div>\n    `;\n  }\n}\ncustomElements.define('table-layout', TableLayout);\n","import { LitElement, html, css } from 'lit-element';\n\nexport class LogLayout extends LitElement {\n  static get layoutName() {\n    return 'Geophysical Log Data';\n  }\n\n  static include(info, context) {\n    return html`<log-layout .info=${info} .context=${context}></log-layout>`;\n  }\n\n  static get properties() {\n    return {\n      info: {\n        type: Object\n      },\n      context: {\n        type: Object\n      }\n    };\n  }\n\n  constructor() {\n    super();\n  }\n\n  static get styles() {\n    return css`\n    `;\n  }\n\n  render() {\n    return html`\n    <table-layout .info=${this.info} .context=${this.context}></table-layout>\n    <pdf-view-button\n      .panel=${this.context.pdfpanel}\n      src=\"${'https://data.wgnhs.wisc.edu/geophysical-logs/' + this.info.Wid + '.pdf'}\">\n    </pdf-view-button>\n    `;\n  }\n}\ncustomElements.define('log-layout', LogLayout);\n","import { LitElement, html, css } from 'lit-element';\n\nexport class CoreLayout extends LitElement {\n  static get layoutName() {\n    return 'Quaternary Core Data';\n  }\n\n  static include(info, context) {\n    return html`<table-layout .info=${info} .context=${context}></table-layout>`;\n  }\n\n  static get properties() {\n    return {\n      info: {\n        type: Object\n      },\n      context: {\n        type: Object\n      }\n    };\n  }\n\n  constructor() {\n    super();\n  }\n\n  static get styles() {\n    return css`\n    `;\n  }\n  render() {\n    return html``;\n  }\n}\ncustomElements.define('core-layout', CoreLayout);\n","import { TableLayout } from './layout/table-layout.js';\nimport { LogLayout } from './layout/log-layout.js';\nimport { CoreLayout } from './layout/core-layout.js';\n\n\nconst defaultLayout = TableLayout;\nconst availableLayouts = [\n  defaultLayout,\n  LogLayout,\n  CoreLayout\n];\n\nexport const layoutResolver = {\n  getLayout: function getLayout(layoutName) {\n    let layout = availableLayouts.find((el) => {\n      return el.layoutName === layoutName;\n    });\n    if (!layout) {\n      layout = defaultLayout;\n    }\n    return layout.include;\n  }\n}","import { LitElement, html, css } from 'lit-element';\nimport { genId, dispatch } from 'wgnhs-common';\nexport { PDFViewButton } from 'wgnhs-viz';\nimport { layoutResolver } from './layout-resolver.js';\n\nexport class SiteDetails extends LitElement {\n  static get properties() {\n    return {\n      siteinfo: {\n        type: Object\n      },\n      pdfpanel: {\n        type: Object\n      }\n    };\n  }\n\n  constructor() {\n    super();\n    this.genId = (function() {\n      const memo = {};\n      return function(index) {\n        if (!memo[index]) {\n          memo[index] = genId();\n        }\n        return memo[index];\n      }\n    })();\n  }\n\n  static get styles() {\n    return css`\n      .header {\n        position: -webkit-sticky;\n        position: sticky;\n        top: 0px;\n        background-color: var(--palette-white);\n        padding: var(--font-size-extra-large) var(--border-radius);\n        z-index: 10;\n        width: 100%;\n        box-sizing: border-box;\n        display: flex;\n        justify-content: space-between;\n      }\n      .header h1 {\n        padding: 0;\n        max-width: 70%;\n        text-align: center;\n      }\n      .header i {\n        font-size: var(--icon-size-large);\n        color: var(--palette-accent);\n        cursor: pointer;\n      }\n      \n      [data-closed] {\n        display: none;\n      }\n    `;\n  }\n\n  renderData(info, layoutName) {\n    const layout = layoutResolver.getLayout(layoutName);\n    return layout(info, this);\n  }\n\n  render() {\n    let Latitude = (this.siteinfo)?this.siteinfo['Latitude']:null;\n    let Longitude = (this.siteinfo)?this.siteinfo['Longitude']:null;\n    let WID = (this.siteinfo)?this.siteinfo['Wid']:null;\n    return html`\n      <style>\n        @import url(\"./css/typography.css\");\n      </style>\n\n      ${(!this.siteinfo)? '' : html`\n        <div class=\"header\">\n          <span>\n            <a href=\"${window.router.link('entry')}\" onclick=\"event.preventDefault()\"><i class=\"material-icons clear-selection\" title=\"Clear selection\" @click=\"${this.fireClearSelection}\" >arrow_back</i></a>\n          </span>\n          <h1>${this.siteinfo.Site_Name}</h1>\n          <span>\n            <i class=\"material-icons zoom-to-site\" title=\"Zoom to site\" @click=\"${this.fireZoomToSite}\">my_location</i>\n          </span>\n        </div>\n        ${this.renderData({\n          Latitude, Longitude, WID\n        })}\n        <h2>Data Available:</h2>\n        ${this.siteinfo.datas.map((props) => html`\n          <app-collapsible open>\n            <span slot=\"header\">${props['Data_Type']}</span>\n            <div slot=\"content\">\n              ${this.renderData(props, props['Data_Type'])}\n            </div>\n          </app-collapsible>\n        `)}\n      `}\n    `;\n  }\n\n  fireClearSelection() {\n    dispatch(this, 'clear-selection', {}, true, true);\n  }\n\n  fireZoomToSite() {\n    dispatch(this, 'zoom-to-site', {params: this.siteinfo}, true, true);\n  }\n}\ncustomElements.define('site-details', SiteDetails);","import { LitElement, html, css } from 'lit-element';\n\nexport class FilterSummary extends LitElement {\n  static get properties() {\n    return {\n      counts: {\n        type: Array\n      }\n    };\n  }\n\n  constructor() {\n    super();\n  }\n\n  static get styles() {\n    return css`\n    `;\n  }\n\n  render() {\n    return (!this.counts)?html``:html`\n    <div>\n      <span>Showing:</span>\n      <ul>\n        <li>\n          <span>\n          ${this.counts.reduce((prev, count) => (count.current + prev), 0)}\n          </span> of <span>\n          ${this.counts.reduce((prev, count) => (count.total + prev), 0)}\n          </span> total sites\n        </li>\n        ${this.counts.map((el) => html`\n        <li>\n          <span>${el.current}</span> of <span>${el.total}</span> sites having <span>${el.name}</span>\n        </li>\n        `)}\n      </ul>\n    </div>\n    `;\n  }\n\n  setCounts(counts) {\n    this.counts = counts;\n  }\n}\ncustomElements.define('filter-summary', FilterSummary);","import { LitElement, html, css } from 'lit-element';\nimport { genId, dispatch } from 'wgnhs-common';\nexport { InRadio, ToggleSwitch } from 'wgnhs-interact';\nexport { AppCollapsible } from 'wgnhs-layout';\nexport { FilterSummary } from './filter-summary.js';\nimport { keyLookup, filterLookup } from '../site-data.js';\nimport { SiteMap } from '../map/site-map.js';\n\nexport class MapFilter extends LitElement {\n  static get properties() {\n    return {\n      include: {\n        type: Array,\n        attribute: false\n      },\n      filter: {\n        type: Array,\n        attribute: false\n      },\n      matchClass: {\n        type: String,\n        attribute: false\n      },\n      sources: {\n        type: Array,\n        attribute: false\n      }\n    };\n  }\n\n  static get styles() {\n    return css`\n      .field {\n        display: grid;\n        grid-template-columns: 40% 1fr;\n        grid-gap: var(--border-radius);\n        margin: 0 var(--border-radius);\n      }\n\n      .label {\n        font-weight: var(--font-weight-bold);\n      }\n\n      .selector {\n      }\n\n      .section-title {\n        margin: var(--line-height) 0 0 0;\n        padding: var(--border-radius);\n        background-color: var(--palette-light);\n      }\n\n      in-radio {\n        display: inline-grid;\n        grid-template-columns: auto auto;\n      }\n    `;\n  }\n\n  updateMatchClass(e) {\n    this.matchClass = e.target.choice;\n  }\n\n  render() {\n    return html`\n      <style>\n        @import url(\"./css/typography.css\");\n      </style>\n      <div>\n        <filter-summary></filter-summary>\n      </div>\n      <div>\n        Show sites that have <in-radio choices='[\"ALL\", \"ANY\"]' @choice-change=\"${this.updateMatchClass}\"></in-radio> of the following:\n      </div>\n      <div>\n        ${this.renderFilterGroups()}\n      </div>\n    `;\n  }\n\n  resolveKeyLookup(field) {\n    let result = (!keyLookup[field])?field:keyLookup[field].title;\n    return result;\n  }\n\n  renderFilterGroups() {\n    let name=0, config=1;\n    return this.filterGroups.map((group) => html`\n      <app-collapsible\n        ?open=${group.open} @open=${this._handle(group)}>\n        <i slot=\"header-before\" class=\"material-icons\">expand_more</i>\n        <span slot=\"header\">${group.title}</span>\n        ${(!group.toggleable)?'':html`\n          <toggle-switch\n            name=\"${group.mapName}\"\n            slot=\"header-after\"\n            ?checked=${group.active}\n            @change=${this._handleGroup(group, 'include')}\n          ></toggle-switch>\n        `}\n        <div slot=\"content\">\n          ${group.sections.map((section, index) => html`\n            ${!(section.title)?'':html`\n              <h2 class=\"section-title\">${section.title}</h2>\n            `}\n            ${Object.entries(section.fields).map((entry, index) => html`\n              <div class=\"field\">\n              ${(entry[config].controls.length === 0)?'':entry[config].controls.map(control => html`\n                <td class=\"label\">\n                  <label for=\"${this.genId(index)}\" >\n                    ${this.resolveKeyLookup(entry[name])}\n                  </label>\n                </td>\n                <td class=\"selector\" \n                    @change=\"${this._handleControl(group, control, 'filter')}\">\n                  <input\n                    type=\"hidden\"\n                    id=\"${control.id}\"\n                    name=\"${entry[name]}\">\n                  ${control.next}\n                </td>\n              `)}\n              </div>\n            `)}\n          `)}\n        </div>\n      </app-collapsible>\n    `);\n  }\n\n  get _eventHandlers() {\n    return {\n      'open' : (context, e) => {\n        context.open = e.detail.value;\n      }\n    }\n  }\n\n  _handle(context) {\n    return (e) => {\n      const handler = this._eventHandlers[e.type];\n      if (handler) {\n        handler(context, e);\n        this.requestUpdate('handle_'+e.type);\n      }\n    }\n  }\n\n  _handleGroup(group, type) {\n    const id = group.id;\n    const handle = group.activate.bind(group);\n    const filter = this[type];\n    const callback = this.requestUpdate.bind(this);\n    return (e) => {\n      const context = {};\n      context.id = id;\n      context.toggleable = group.toggleable;\n      context.detail = e.detail;\n      context.prop = group.prop;\n      context.value = group[group.prop];\n      removeFromFilter(filter, id);\n      let resolver = handle(context);\n      if (resolver) {\n        filter.push(resolver);\n      }\n      callback(type);\n    }\n  }\n\n  _handleControl(group, control, type) {\n    const id = control.id;\n    const handle = control.handle.bind(control);\n    const filter = this[type];\n    const callback = this.requestUpdate.bind(this);\n    return (e) => {\n      const context = {};\n      context.id = id;\n      context.group = group;\n      context.target = e.currentTarget.querySelector('#'+id);\n      context.prop = context.target.name;\n      removeFromFilter(filter, id);\n      let resolver = handle(context);\n      if (resolver) {\n        filter.push(resolver);\n      }\n      callback(type);\n    }\n  }\n\n  updated(changed) {\n    const isNeeded = (\n      changed.has('matchClass') ||\n      changed.has('include') ||\n      changed.has('filter') ||\n      changed.has('sources'));\n\n    if (this.sources && isNeeded) {\n      const activePoints = MapFilter.runFilter({\n        matchClass: this.matchClass,\n        incl: this.include,\n        filt: this.filter,\n        sources: this.sources\n      });\n      this.$summary.setCounts(MapFilter.getResultsInfo(this.sources, activePoints));\n      dispatch(this, 'filtered', {activePoints});\n    }\n  }\n\n  firstUpdated() {\n    this.$summary = this.renderRoot.querySelector('filter-summary');\n  }\n\n  init(uniques, layers) {\n    this.filterGroups.forEach((group) => {\n      group.sections.forEach((section) => {\n        Object.entries(section.fields).forEach((field) => {\n          field[1].controls.forEach((control) => {\n            if (control.init) {\n              control.init(uniques[field[0]]);\n            }\n          })\n        })\n      })\n    });\n\n    this.sources = layers;\n  }\n\n  static runFilter({matchClass, incl, filt, sources}) {\n    const resolve = function runPointThroughFilters(props) {\n      let included = incl.length > 0 && incl.reduce((prev, curr) => {\n        return prev || curr.resolve(props);\n      }, false);\n      let spec = filt.filter((rule) => rule.resolveGroup(props));\n      let result = included && spec.length < 1;\n      if (included && !result) {\n        if (\"ALL\" === matchClass) {\n          result = spec.reduce((prev, curr) => {\n            return prev && curr.resolve(props);\n          }, true);\n        } else {\n          result = spec.reduce((prev, curr) => {\n            return prev || curr.resolve(props);\n          }, false);\n        }\n      }\n      return result;\n    }\n\n    const result = sources.map((layer) => {\n      const activePoints = new Set();\n      Object.entries(layer._layers).forEach((ent) => {\n        if (resolve(ent[1].feature.properties)) {\n          activePoints.add('' + SiteMap.getSiteCode(ent[1].feature.properties));\n        }\n      });\n      return activePoints;\n    });\n\n    return result;\n  }\n\n  static getResultsInfo(sources, activePoints) {\n    const result = sources.map((layer, i) => {\n      let stats = {};\n      stats.name = layer.options.name;\n\n      let entries = Object.entries(layer._layers);\n      stats.total = entries.length;\n      stats.current = activePoints[i].size;\n\n      return stats;\n    });\n    return result;\n  }\n\n  constructor() {\n    super();\n    this.genId = (function() {\n      const memo = {};\n      return function(index) {\n        if (!memo[index]) {\n          memo[index] = genId();\n        }\n        return memo[index];\n      }\n    })();\n    this.include = [];\n    this.filter = [];\n    this.filterGroups = filterLookup;\n  }\n}\ncustomElements.define('map-filter', MapFilter);\n\nconst removeFromFilter = (filter, id) => {\n  for (\n    var idx = filter.findIndex(el => el.id === id); \n    idx >= 0;\n    idx = filter.findIndex(el => el.id === id)\n  ) {\n    filter.splice(idx, 1);\n  }\n}\n\n","import { SiteMap } from './map/site-map.js';\nimport { SiteData } from './site-data.js';\nimport { SiteRouter } from './site-router.js';\nexport { SiteDetails } from './details/site-details.js';\nexport { MapFilter } from './filter/map-filter.js';\n\nwindow.siteMap = new SiteMap();\nwindow.sidebar = document.querySelector('#sidebar');\nwindow.pdfPanel = document.querySelector('#sketch');\ndocument.querySelectorAll('site-details').forEach(function(details) {\n  details['pdfpanel'] = window.pdfPanel;\n});\nwindow.filter = document.querySelector('#filter');\n\nwindow.siteMap.once('init', function() {\n  window.siteData = new SiteData(window.siteMap.layers);\n  window.aggrData = siteData.aggrData;\n  filter.init(window.siteData.uniques, window.siteMap.layers);\n\n  var deselectFeature = function() {\n    window.pdfPanel.hide();\n    document.querySelectorAll('site-details').forEach(function(details) {\n      details['siteinfo'] = null;\n    });\n  }\n\n  async function selectFeature(info) {\n    deselectFeature();\n    document.querySelectorAll('site-details').forEach(function(details) {\n      details['siteinfo'] = info;\n    });\n    return true;\n  };\n\n  window.router = new SiteRouter();\n  window.router.addRoute({\n    name: 'entry',\n    url: '/',\n    onEnter: function(trans, state) {\n      // console.log('route-entry');\n      window.siteMap.clearSelection();\n      deselectFeature();\n      document.querySelector('#app').setAttribute('data-view', 'app');\n      window.sidebar.switchTab('default');\n      window.siteMap.setVisibility(true);\n    },\n    onExit: function(trans, state) {\n\n    },\n  });\n  window.router.addRoute({\n    name: 'view',\n    url: '/view/:Site_Code',\n    // params: {\n    //   'Site_Code': {\n    //     array: true\n    //   }\n    // },\n    onEnter: function(trans, state) {\n      // console.log('route-view');\n      let params = trans.params();\n      let attr = window.siteMap.selectSite(params);\n      if (attr) {\n        document.querySelectorAll('site-details').forEach(function(details) {\n          details['printLayout'] = false;\n        });\n        selectFeature(attr).then(() => {\n          document.querySelector('#app').setAttribute('data-view', 'app');\n          window.sidebar.switchTab('details');\n          window.siteMap.setVisibility(true);\n        })\n      } else {\n        window.router.clearRoute();\n      }\n    },\n    onExit: function(trans, state) {\n\n    },\n  });\n  window.router.addRoute({\n    name: 'print',\n    url: '/print/:Site_Code',\n    // params: {\n    //   'Site_Code': {\n    //     array: true\n    //   }\n    // },\n    onEnter: function(trans, state) {\n      // console.log('route-print');\n      let params = trans.params();\n      let attr = window.siteMap.selectSite(params);\n      if (attr) {\n        document.querySelectorAll('site-details').forEach(function(details) {\n          details['printLayout'] = true;\n        });\n        selectFeature(attr).then(() => {\n          document.querySelector('#app').removeAttribute('data-view');\n          window.sidebar.switchTab('details');\n          window.siteMap.setVisibility(false);\n        })\n      } else {\n        window.router.clearRoute();\n      }\n    },\n    onExit: function(trans, state) {\n\n    },\n  });\n  window.router.router.transitionService.onEnter({}, ()=>{\n    document.querySelector('#spinner').setAttribute('data-closed', true);\n  });\n  // Start the router\n  window.router.start();\n\n  window.siteMap.on('interaction', (params) => {\n    if (params['Site_Code']) {\n      window.router.setRoute('view', params);\n    } else {\n      window.router.clearRoute();\n    }\n  });\n});\n\ndocument.addEventListener('clear-selection', function(e) {\n  window.router.clearRoute();\n});\n\ndocument.addEventListener('zoom-to-site', function(e) {\n  window.siteMap.zoomToPoint(e.detail.params);\n})\n\ndocument.addEventListener('toggle-print', function(e) {\n  if (e.detail.on) {\n    window.router.setRoute('print', e.detail.params);\n  } else {\n    window.router.setRoute('view', e.detail.params);\n  }\n});\n\ndocument.addEventListener('toggle-pdf-panel', function(e) {\n  window.siteMap.setVisibility(e.detail.closed);\n});\n\nwindow.filter.addEventListener('filtered', function(e) {\n  window.siteMap.updatePoints(e.detail.activePoints);\n});"],"names":["RestylingCircleMarker","L","CircleMarker","extend","getEvents","zoomend","this","_restyle","filterpoints","_filter","e","setRadius","calcRadius","target","getZoom","detail","resolve","feature","properties","setStyle","stroke","fill","highlight","_activeBackup","color","options","removeHighlight","a","Math","max","floor","SiteMap","window","Evented","[object Object]","super","selected","_highlight","map","zoomControl","setView","el","document","querySelector","Control","Zoom","position","addTo","basemaps","tileLayer","attribution","label","esri","basemapLayer","addControl","control","tileX","tileY","tileZ","Promise","all","fetch","then","res","json","geojson","name","data","responses","layers","geoJSON","pointToLayer","geoJsonPoint","latlon","weight","radius","forEach","l","on","propagatedFrom","fire","lookup","layer","idx","arr","eachLayer","obj","wid","siteCode","getSiteCode","siteName","latLon","getLatLng","cache","Site_Code","Site_Name","Wid","Latitude","toFixed","Longitude","point","datas","Array","length","_lookup","params","reduce","prev","curr","undefined","result","site","getPoint","setZoomAround","bringToFront","clearSelection","getHighlightPoint","setHighlightPoint","getSite","selectPoint","bringToBack","activePoints","props","activeSet","code","has","isVisible","removeAttribute","invalidateSize","setAttribute","FilterGroup","config","Object","assign","id","genId","context","input","checked","toggleable","prop","value","CheckboxControl","next","html","nextElementSibling","resolveGroup","group","GTLTControl","isDate","gtName","ltName","b","predicate","isValid","SelectControl","uniques","from","sort","SiteData","_aggrKeys","aggrData","push","_gatherAggrData","concat","key","Set","filter","aggrKeys","aggr","min","ignoredKeys","keyLookup","SiteName","title","desc","ID","RecentLog","MaxDepth","Norm_Res","Caliper","Gamma","SP","SPR","Spec_Gamma","Fluid_Cond","Flow_Spin","Fluid_Temp","Fluid_Res","OBI","ABI","Video","Drill_Year","Depth_Ft","Drill_Meth","Subsamples","Photos","Grainsize","filterLookup","open","sections","fields","County","controls","trim","toUpperCase","includes","Data_Type","active","Flow_HP","DEFAULT_ROUTE","TableLayout","LitElement","layoutName","info","type","styles","css","entries","index","customElements","define","LogLayout","pdfpanel","CoreLayout","defaultLayout","availableLayouts","layoutResolver","getLayout","layout","find","include","SiteDetails","siteinfo","memo","WID","router","link","fireClearSelection","fireZoomToSite","renderData","dispatch","counts","count","current","total","MapFilter","attribute","matchClass","String","sources","choice","updateMatchClass","renderFilterGroups","field","filterGroups","_handle","mapName","_handleGroup","section","entry","resolveKeyLookup","_handleControl","_eventHandlers","handler","requestUpdate","handle","activate","bind","callback","removeFromFilter","resolver","currentTarget","changed","isNeeded","runFilter","incl","filt","$summary","setCounts","getResultsInfo","renderRoot","init","_layers","ent","included","spec","rule","add","i","stats","size","findIndex","splice","siteMap","sidebar","pdfPanel","querySelectorAll","details","once","siteData","deselectFeature","hide","async","selectFeature","UIRouter","plugin","pushStateLocationPlugin","servicesPlugin","routes","urlService","rules","initial","state","otherwise","listen","sync","stateRegistry","register","setRoute","arguments","stateService","go","href","func","transitionService","onEnter","onExit","addRoute","url","trans","switchTab","setVisibility","attr","selectSite","clearRoute","start","addEventListener","zoomToPoint","closed","updatePoints"],"mappings":"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"}